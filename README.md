# Exposing _C++_ in one R Package to Another R Package

<!-- badges: start -->
[![Travis build status](https://travis-ci.org/r-pkg-examples/rcpp-shared-cpp-functions.svg?branch=master)](https://travis-ci.org/r-pkg-examples/rcpp-shared-cpp-functions)
<!-- badges: end -->

The `RcppHeaderSharing` _R_ package provides an example of providing a set
of _C++_ functions in one _R_ package to be used by other _R_ packages. There 
are multiple approaches to facilitate such a framework. Within this project, the
focus is on distributing _C++_ header files within one of the _R_ packages 
by making a _C++ header-only_ library through the extensive use of `inline`
keyword. 

### Usage

To install the package, you must first have a compiler on your system that is
compatible with R. For help on obtaining a compiler consult either
[macOS](http://thecoatlessprofessor.com/programming/r-compiler-tools-for-rcpp-on-os-x/)
or
[Windows](http://thecoatlessprofessor.com/programming/rcpp/install-rtools-for-rcpp/)
guides.

With a compiler in hand, one can then install the package from GitHub by:

```r
# install.packages("devtools")
devtools::install_github("r-pkg-examples/rcpp-shared-cpp-functions")
library("RcppHeaderSharing")
```

### Implementation Details

This project focuses on showcasing how to package in _R_ a _C++ header-only_ library.
By approaching sharing _C++_ functions in this manner, the complexity is reduced
at the expense of compile time during development and initial installation.
Complexity reduction arises from the library not needing to be initially
compiled, packaged, and then installed on a local user's computer. 

Principally, _header-only_ libraries combine both the function definition 
and implementation within the header files denoted by `.h` or `.hpp`.
In comparison, traditional _C++_ implementations that rely upon `.cpp` and `.hpp` 
file pairing result in the header files (`.hpp`) containing only a minimal 
"bones" public-facing implementation while the meat of the implementation is
done in `.cpp`.

```bash
.
├── DESCRIPTION                      # Package metadata
├── LICENSE                          # Code license
├── NAMESPACE                        # Function and dependency registration
├── R                                # R functions
│   ├── RcppExports.R                # Autogenerated R to C++ bindings by Rcpp
│   └── RcppHeaderSharing-package.R  # Package documentation
├── README.md
├── RcppHeaderSharing.Rproj
├── inst                             # C++ Headers
│   └── include
│       ├── RcppHeaderSharing.h      # Main header file
│       ├── hello
│       │   └── say_hello.h          # Individual header file with inline func
│       └── rcpp_math
│           └── add_numbers.h
├── man                              # Package Documentation
│   ├── RcppHeaderSharing-package.Rd
│   └── add_numbers.Rd
└── src                              # Compiled Code
    ├── Makevars                     # Set compilation flag to include headers
    ├── Makevars.win
    ├── RcppExports.cpp              # Autogenerated R Bindings
    └── export-inline-header.cpp     # Surface into R a C++ header function.
```

#### Headers 

Todo: Add explanation

#### Inline 

Todo: Add explanation

### Inclusion in another R package

In the other _R_ package, modify the `DESCRIPTION` file's `LinkingTo:` field
to include the package name. 

```
LinkingTo: Rcpp, package_name
Imports:
    Rcpp (>= 0.12.11)
```

Within a _C++_ file in `src/`, then add:

```cpp
#include <Rcpp.h>
#include <package_name.h>
```

Retrieve the function definitions with a namespaced function call, e.g.

```cpp
package_name::function_name()
```

### Reference Implementations

Samples of using making available functions via a _C++ header-only_ library
_R_ package:

- [`Rcpp`](https://github.com/rcppcore/rcpp)
- [`RcppArmadillo`](https://github.com/rcppcore/rcpparmadillo)
- [`RcppEigen`](https://github.com/rcppcore/rcppeigen)
- [`sitmo`](https://github.com/coatless/sitmo)


## License

GPL (\>= 2)
